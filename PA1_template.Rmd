---
title: "Reproducible Research: Peer Assessment 1"
author: "Kevin Siswandi"
date: "14 July 2015"
output: 
  html_document:
    keep_md: true
    
---

# Title to be decided

## Loading and preprocessing the data
  
The dataset (activity.csv) is included in this repository and can be downloaded from  
https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip  

In this section, we load and take a quick peek at the data.  

```{r}
activity <- read.csv("activity.csv")
```

```{r}
head(activity)
tail(activity)
summary(activity)
```

The interval variable is recorded in the format of hours followed by minutes. For example, 55 refers to 00:55 (zero hours and 55 minutes) and 100 refers to 01:00 (one hour and zero minutes). We'll preprocess this variable as needed in the subsequent sections.  




## What is mean total number of steps taken per day?
  
First of all, let's calculate the total number of steps for each day. There are missing values on some days, but let's ignore that for now.  

```{r}
steps_per_day <- sapply(split(activity, activity$date), function(x) (sum(x[, 1])))
```

steps_per_day contains the total number of steps each day over the two months period. We can directly compute the mean and median and plot a histogram from this variable:  

```{r histogram}
steps_mean <- mean(steps_per_day, na.rm = TRUE); steps_mean
steps_median <- median(steps_per_day, na.rm = TRUE); steps_median

hist(steps_per_day, main = "Number of steps", breaks = 10, col = "green")
abline(v = steps_mean, col = "red", lwd = 2, lty = 2)
abline(v = steps_median, col = "blue", lwd = 2)
```

As we can see in the figure above, the mean and the median are very close together.  




## What is the average daily activity pattern?

In this section, we'll examine the average daily activity within the two months period.

```{r}
#Split activity by interval
s <- split(activity, activity$interval) 

#Take the daily average of steps for each interval
daily_average <- sapply(s, function(x) (mean(x[,1], na.rm = TRUE)))

#Convert the intervals to POSIXct time variables
interval <- strptime(sprintf("%04d", unique(activity$interval)), format = "%H%M")

#The interval with maximum number of steps
which.max(daily_average)

daily_average["835"]; daily_average[104]
```

A time-series plot of the (daily average) number of steps taken:  

```{r}
plot(interval, daily_average, type = "l", ylab = "number of steps", main = "Daily average activity")
```

As evident from the plot, the maximum number of steps is around 08:35, which is consistent with our *which.max* result above.  




## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
